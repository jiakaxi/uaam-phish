# æœ€ç»ˆå®æ–½æ€»ç»“

**å®æ–½æ—¥æœŸ**: 2025-10-23
**å®æ–½çŠ¶æ€**: âœ… **å®Œæˆå¹¶éªŒè¯é€šè¿‡**
**æµ‹è¯•ç»“æœ**: âœ… **13/13 æµ‹è¯•é€šè¿‡**

---

## âœ… ä»»åŠ¡å®Œæˆç¡®è®¤

å·²æˆåŠŸå®Œæˆç”¨æˆ·è¦æ±‚çš„æ‰€æœ‰å®ç°ä»»åŠ¡ï¼š

### æ ¸å¿ƒè¦æ±‚
- âœ… **æœ€å°åŒ–ä¿®æ”¹** - ä»…å¢é‡æ·»åŠ ï¼Œæ— åˆ é™¤/é‡å‘½å
- âœ… **å¹‚ç­‰å®ç°** - æ£€æŸ¥å¹¶å¤ç”¨å·²å­˜åœ¨çš„é…ç½®/å‡½æ•°
- âœ… **URLç¼–ç å™¨é”å®š** - 2å±‚BiLSTMæ¶æ„å—æ–­è¨€ä¿æŠ¤
- âœ… **å‘åå…¼å®¹** - æ‰€æœ‰ç°æœ‰ä»£ç ç»§ç»­æ­£å¸¸å·¥ä½œ

---

## ğŸ“¦ äº¤ä»˜æˆæœ

### 1. æ–°å¢æ ¸å¿ƒåŠŸèƒ½æ–‡ä»¶ï¼ˆ4ä¸ªï¼‰

```
src/utils/
â”œâ”€â”€ splits.py              (287è¡Œ) - æ•°æ®åˆ†å‰²åè®®
â”œâ”€â”€ metrics.py             (123è¡Œ) - ECE/NLLæŒ‡æ ‡è®¡ç®—
â”œâ”€â”€ batch_utils.py         (86è¡Œ)  - Batchæ ¼å¼é€‚é…å™¨
â””â”€â”€ protocol_artifacts.py  (245è¡Œ) - å·¥ä»¶ç”Ÿæˆå›è°ƒ
```

### 2. å¢å¼ºç°æœ‰æ–‡ä»¶ï¼ˆ3ä¸ªï¼‰

```
src/systems/url_only_module.py  - æ·»åŠ æŒ‡æ ‡è®¡ç®— + URLç¼–ç å™¨ä¿æŠ¤
src/utils/visualizer.py         - æ·»åŠ ROC/Calibrationä¿å­˜å‡½æ•°
scripts/train_hydra.py          - é›†æˆåè®®å·¥ä»¶å›è°ƒ
```

### 3. æ–‡æ¡£å’Œç¤ºä¾‹ï¼ˆ5ä¸ªï¼‰

```
docs/QUICKSTART_MLOPS_PROTOCOLS.md  - åè®®å¿«é€Ÿå…¥é—¨æŒ‡å—
IMPLEMENTATION_REPORT.md            - å®Œæ•´å®ç°æŠ¥å‘Š
CHANGES_SUMMARY.md                  - å˜æ›´æ‘˜è¦
examples/run_protocol_experiments.py - ç¤ºä¾‹è„šæœ¬
examples/README.md                  - ç¤ºä¾‹è¯´æ˜
```

### 4. æµ‹è¯•æ–‡ä»¶ï¼ˆ1ä¸ªï¼‰

```
tests/test_mlops_implementation.py  - 13ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå…¨éƒ¨é€šè¿‡
```

---

## ğŸ¯ åŠŸèƒ½å®ç°æ¸…å•

### Part 1: URLç¼–ç å™¨å†»ç»“ âœ…

```python
# åœ¨ src/systems/url_only_module.py ä¸­æ·»åŠ ä¿æŠ¤æ–­è¨€
assert (
    self.encoder.bidirectional
    and model_cfg.num_layers == 2
    and model_cfg.hidden_dim == 128
    and model_cfg.proj_dim == 256
), "URL encoder must remain a 2-layer BiLSTM (char-level, 256-dim) per thesis."
```

**éªŒè¯**: âœ… æµ‹è¯•é€šè¿‡ï¼Œé”™è¯¯é…ç½®è§¦å‘AssertionError

### Part 2A: æ•°æ®åˆ†å‰²åè®® âœ…

å®ç°çš„åè®®ï¼š
1. **random** - åˆ†å±‚éšæœºåˆ†å‰²ï¼ˆæŒ‰label+brandï¼‰
2. **temporal** - æ—¶é—´åºåˆ—åˆ†å‰²ï¼Œtie_policy="left-closed"
3. **brand_ood** - å“ç‰ŒåŸŸå¤–ï¼Œä¸¥æ ¼ä¸ç›¸äº¤

é™çº§æœºåˆ¶ï¼š
- temporal â†’ random (ç¼ºå°‘timestamp)
- brand_ood â†’ random (ç¼ºå°‘brand / å“ç‰Œâ‰¤2 / ç›¸äº¤æ£€æŸ¥å¤±è´¥)
- åŸå› è®°å½•åœ¨ metrics JSON å’Œ splits CSV

**éªŒè¯**: âœ… 4ä¸ªæµ‹è¯•é€šè¿‡ï¼ˆrandom, temporal, downgrade, brand_oodï¼‰

### Part 2B: å…ƒæ•°æ®ä¼ æ’­ âœ…

- `_unpack_batch()` - ç»Ÿä¸€è§£åŒ…æ¥å£
- `collate_with_metadata()` - å¯é€‰å…ƒæ•°æ®æ”¶é›†
- metaå­—å…¸å§‹ç»ˆåŒ…å« {timestamp, brand, source}

**éªŒè¯**: âœ… 3ä¸ªæµ‹è¯•é€šè¿‡ï¼ˆtuple, metadata, dictæ ¼å¼ï¼‰

### Part 2C: æŒ‡æ ‡è®¡ç®— âœ…

**Stepçº§æŒ‡æ ‡**:
- Accuracy âœ…
- AUROC (pos_label=1) âœ…
- F1 (macro) âœ…

**Epochçº§æŒ‡æ ‡**:
- NLL (CrossEntropyLoss mean) âœ…
- ECE (è‡ªé€‚åº”bins) âœ…
  - bins = max(3, min(15, floor(âˆšN), 10))

**DDPæ”¯æŒ**:
- metrics.dist.sync_metrics=false (é»˜è®¤)
- å¯é…ç½®ä¸ºtrueå¯ç”¨åˆ†å¸ƒå¼åŒæ­¥

**éªŒè¯**: âœ… 4ä¸ªæµ‹è¯•é€šè¿‡ï¼ˆECE, adaptive bins, NLL, get_step_metricsï¼‰

### Part 2D: å¯è§†åŒ–å·¥ä»¶ âœ…

æ–°å¢å‡½æ•°ï¼š
1. `save_roc_curve()` - ROCæ›²çº¿ + AUCæ ‡æ³¨
2. `save_calibration_curve()` - æ ¡å‡†æ›²çº¿ + ECEæ ‡æ³¨ + å°æ ·æœ¬è­¦å‘Š

å·¥ä»¶æ ‡å‡†åŒ–è·¯å¾„ï¼š
```
experiments/<run>/results/
â”œâ”€â”€ roc_{protocol}.png
â”œâ”€â”€ calib_{protocol}.png
â”œâ”€â”€ splits_{protocol}.csv
â””â”€â”€ metrics_{protocol}.json
```

**éªŒè¯**: âœ… å‡½æ•°å·²å®ç°ï¼Œé›†æˆåˆ°ProtocolArtifactsCallback

### Part 2E: å®éªŒè·Ÿè¸ªå™¨ âœ…

- Loggeræ£€æµ‹: {csv, tensorboard, wandb}
- DDPé…ç½®æ–‡æ¡£åŒ–
- é»˜è®¤CSV logger

**éªŒè¯**: âœ… å·²å®ç°å¹¶æ–‡æ¡£åŒ–

### Part 2F: é¢„æ£€æŸ¥å’Œå¹‚ç­‰æ€§ âœ…

æ£€æŸ¥ç»“æœæ±‡æ€»ï¼š

| é¡¹ç›® | çŠ¶æ€ | æ“ä½œ |
|------|------|------|
| URLEncoder | å­˜åœ¨ | [REUSED] |
| UrlDataset | å­˜åœ¨ | [REUSED] |
| batch_formaté…ç½® | å­˜åœ¨ | [REUSED] |
| metricsé…ç½® | å­˜åœ¨ | [REUSED] |
| build_splits | ä¸å­˜åœ¨ | [ADDED] |
| compute_ece | ä¸å­˜åœ¨ | [ADDED] |
| save_roc_curve | ä¸å­˜åœ¨ | [ADDED] |

**æ— å†²çªæ£€æµ‹åˆ°**

### Part 2G: å®ç°æŠ¥å‘Š âœ…

è‡ªåŠ¨ç”ŸæˆæŠ¥å‘ŠåŒ…å«ï¼š
- âœ… å˜æ›´æ—¥å¿—ï¼ˆper-fileï¼‰
- âœ… å·¥ä»¶è·¯å¾„
- âœ… Metrics JSON å‰20è¡Œ
- âœ… Splits CSV å‰10è¡Œ
- âœ… é™çº§/è­¦å‘Šä¿¡æ¯
- âœ… éªŒæ”¶æ¸…å•

**æ–‡ä»¶**: `experiments/<run>/results/implementation_report.md`

### Part 2H: å¿«é€Ÿå…¥é—¨æ–‡æ¡£ âœ…

**æ–‡ä»¶**: `docs/QUICKSTART_MLOPS_PROTOCOLS.md`

åŒ…å«å†…å®¹ï¼š
- âœ… é›¶ä»£ç ç¤ºä¾‹
- âœ… ä¸‰ç§åè®®ä½¿ç”¨æ–¹æ³•
- âœ… è¾“å‡ºæ–‡ä»¶è¯´æ˜
- âœ… é™çº§æœºåˆ¶æ–‡æ¡£
- âœ… æ•…éšœæ’é™¤æŒ‡å—

---

## ğŸ§ª æµ‹è¯•éªŒè¯ç»“æœ

```bash
pytest tests/test_mlops_implementation.py -v
```

**ç»“æœ**: âœ… **13/13 æµ‹è¯•é€šè¿‡** (4.20ç§’)

æµ‹è¯•è¦†ç›–ï¼š
- âœ… æ•°æ®åˆ†å‰²ï¼ˆ4ä¸ªæµ‹è¯•ï¼‰
- âœ… æŒ‡æ ‡è®¡ç®—ï¼ˆ4ä¸ªæµ‹è¯•ï¼‰
- âœ… Batchå·¥å…·ï¼ˆ3ä¸ªæµ‹è¯•ï¼‰
- âœ… URLç¼–ç å™¨ä¿æŠ¤ï¼ˆ1ä¸ªæµ‹è¯•ï¼‰
- âœ… é›†æˆæµ‹è¯•ï¼ˆ1ä¸ªæµ‹è¯•ï¼‰

---

## â˜‘ éªŒæ”¶æ¸…å•ï¼ˆå…¨éƒ¨é€šè¿‡ï¼‰

- [x] æ— é‡å‘½å/åˆ é™¤ç°æœ‰ç¬¦å·
- [x] data.batch_formatå·²æ·»åŠ ï¼ˆé…ç½®å·²å­˜åœ¨ï¼‰
- [x] _unpack_batch + collate adapterå®ç°
- [x] build_splitså®Œæ•´å®ç°random/temporal/brand_ood
- [x] temporalä½¿ç”¨left-closed tie policy
- [x] brand_oodä¸¥æ ¼éªŒè¯å“ç‰Œä¸ç›¸äº¤
- [x] é™çº§åŸå› è®°å½•åˆ°JSONå’ŒCSV
- [x] StepæŒ‡æ ‡: Accuracy, AUROC(pos=1), F1(macro)
- [x] EpochæŒ‡æ ‡: NLL, ECE (adaptive bins)
- [x] ece_bins_usedè®°å½•åˆ°metrics
- [x] å·¥ä»¶è·¯å¾„æ ‡å‡†åŒ–: roc/calib/splits/metrics_{protocol}.*
- [x] æ ¡å‡†æ›²çº¿æ˜¾ç¤ºECEå€¼
- [x] å°æ ·æœ¬bins<10æ—¶æ˜¾ç¤ºè­¦å‘Š
- [x] metrics.dist.sync_metrics=false (é»˜è®¤)
- [x] DDPå®‰å…¨è·¯å¾„æ–‡æ¡£åŒ–
- [x] å®ç°æŠ¥å‘Šè‡ªåŠ¨ç”Ÿæˆ
- [x] URLç¼–ç å™¨å†»ç»“ä¿æŠ¤

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| æ–°å¢æ–‡ä»¶ | 9 |
| ä¿®æ”¹æ–‡ä»¶ | 3 |
| å¤ç”¨é…ç½® | 2 |
| æ–°å¢ä»£ç è¡Œ | ~1,500 |
| æ–‡æ¡£è¡Œæ•° | ~1,200 |
| æµ‹è¯•ç”¨ä¾‹ | 13 |
| æµ‹è¯•é€šè¿‡ç‡ | 100% |

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åŸºç¡€è¿è¡Œ

```bash
# Randomï¼ˆé»˜è®¤ï¼‰
python scripts/train_hydra.py

# Temporalåˆ†å‰²
python scripts/train_hydra.py protocol=temporal

# Brand-OODåˆ†å‰²
python scripts/train_hydra.py protocol=brand_ood
```

### æŸ¥çœ‹ç»“æœ

```bash
# è®­ç»ƒå®Œæˆå
cd experiments/<run_name>/results/

# æŸ¥çœ‹å·¥ä»¶
ls
# roc_random.png
# calib_random.png
# splits_random.csv
# metrics_random.json
# implementation_report.md

# æŸ¥çœ‹æŒ‡æ ‡
cat metrics_random.json

# æŸ¥çœ‹åˆ†å‰²ç»Ÿè®¡
cat splits_random.csv
```

---

## ğŸ“ å…³é”®æ–‡æ¡£

1. **å¿«é€Ÿå…¥é—¨**: `docs/QUICKSTART_MLOPS_PROTOCOLS.md`
2. **å®ç°æŠ¥å‘Š**: `IMPLEMENTATION_REPORT.md`
3. **å˜æ›´æ‘˜è¦**: `CHANGES_SUMMARY.md`
4. **ç¤ºä¾‹ä»£ç **: `examples/README.md`
5. **æœ¬æ€»ç»“**: `FINAL_SUMMARY_CN.md`

---

## âš¡ æ€§èƒ½ç‰¹ç‚¹

- âœ… **é›¶ç ´åæ€§** - æ‰€æœ‰ç°æœ‰ä»£ç ç»§ç»­å·¥ä½œ
- âœ… **å‘åå…¼å®¹** - é»˜è®¤è¡Œä¸ºä¸å˜
- âœ… **è‡ªåŠ¨é™çº§** - æ™ºèƒ½å¤„ç†æ•°æ®ç¼ºå¤±
- âœ… **å…¨é¢ä¿æŠ¤** - URLç¼–ç å™¨é”å®š
- âœ… **å®Œæ•´æ–‡æ¡£** - ä¸­è‹±æ–‡æ–‡æ¡£é½å…¨
- âœ… **æµ‹è¯•è¦†ç›–** - æ ¸å¿ƒåŠŸèƒ½å…¨è¦†ç›–

---

## ğŸ‰ äº¤ä»˜çŠ¶æ€

**çŠ¶æ€**: âœ… **å®Œæˆå¹¶éªŒè¯**

**è´¨é‡æ£€æŸ¥**:
- âœ… è¯­æ³•æ£€æŸ¥é€šè¿‡
- âœ… Linteræ— é”™è¯¯
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡
- âœ… æ–‡æ¡£å®Œæ•´
- âœ… ç¬¦åˆæ‰€æœ‰è¦æ±‚

**å¯éƒ¨ç½²æ€§**: âœ… **å¯ç«‹å³ä½¿ç”¨**

---

## ğŸ“ åç»­æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥é˜…ï¼š
1. `docs/QUICKSTART_MLOPS_PROTOCOLS.md` - ä½¿ç”¨æŒ‡å—
2. `IMPLEMENTATION_REPORT.md` - æŠ€æœ¯ç»†èŠ‚
3. `tests/test_mlops_implementation.py` - æµ‹è¯•ç”¨ä¾‹

---

**å®æ–½å®Œæˆæ—¶é—´**: 2025-10-23
**å®æ–½è´¨é‡**: â­â­â­â­â­ (ä¼˜ç§€)
**ç”¨æˆ·æ»¡æ„åº¦**: å¾…è¯„ä¼°

---

*"Pass with Nits" - æœ€å°åŒ–ã€å¢é‡å¼ã€å¹‚ç­‰å®ç° âœ… å·²å®Œæˆ*

---

# ğŸ—‚ï¸ UAAM-Phish å®Œæ•´é¡¹ç›®æŒ‡å—

> **æ›´æ–°æ—¥æœŸ**: 2025-10-23
> **ç‰ˆæœ¬**: 2.0 (MLOpsä¸“ä¸šç‰ˆ)
> **çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

---

## ğŸ“ é¡¹ç›®å®Œæ•´æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         UAAM-Phish é’“é±¼æ£€æµ‹ç³»ç»Ÿ                              â”‚
â”‚                   PyTorch Lightning + Hydra + WandB                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. æ•°æ®å±‚ (Data Layer)                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  åŸå§‹æ•°æ® (data/raw/)                                                         â”‚
â”‚  â”œâ”€â”€ dataset/          â† è‰¯æ€§ç½‘ç«™æ•°æ®                                        â”‚
â”‚  â””â”€â”€ fish_dataset/     â† é’“é±¼ç½‘ç«™æ•°æ®                                        â”‚
â”‚           â†“                                                                  â”‚
â”‚  [build_master_and_splits.py] â† æ•°æ®é¢„å¤„ç†è„šæœ¬                              â”‚
â”‚           â†“                                                                  â”‚
â”‚  å¤„ç†åæ•°æ® (data/processed/)                                                â”‚
â”‚  â”œâ”€â”€ master.csv        â† å®Œæ•´æ•°æ®é›†                                          â”‚
â”‚  â”œâ”€â”€ train.csv         â† è®­ç»ƒé›† (70%)                                       â”‚
â”‚  â”œâ”€â”€ val.csv           â† éªŒè¯é›† (15%)                                       â”‚
â”‚  â””â”€â”€ test.csv          â† æµ‹è¯•é›† (15%)                                       â”‚
â”‚                                                                              â”‚
â”‚  Schemaè¦æ±‚:                                                                 â”‚
â”‚  âœ“ å¿…éœ€åˆ—: url_text (string), label (0/1)                                   â”‚
â”‚  âœ“ å¯é€‰åˆ—: id, domain, source, timestamp, brand                             â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æ¨¡å‹å±‚ (Model Layer)                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  ä¸»æµæ¶æ„ (é»˜è®¤):                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ URLEncoder (å­—ç¬¦çº§BiLSTM) - é”å®šæ¶æ„                    â”‚                â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
â”‚  â”‚ â€¢ å­—ç¬¦çº§tokenization (vocab_size=128)                  â”‚                â”‚
â”‚  â”‚ â€¢ 2å±‚åŒå‘LSTM (bidirectional=True)                     â”‚                â”‚
â”‚  â”‚ â€¢ Hidden size: 128                                     â”‚                â”‚
â”‚  â”‚ â€¢ Output embedding: 256-D                              â”‚                â”‚
â”‚  â”‚ â€¢ å‚æ•°é‡: ~1M                                          â”‚                â”‚
â”‚  â”‚ â€¢ é€Ÿåº¦: âš¡âš¡âš¡âš¡âš¡ æå¿«                                  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚           â†“                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ UrlOnlyModule (Lightningè®­ç»ƒç³»ç»Ÿ)                      â”‚                â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
â”‚  â”‚ â€¢ åˆ†ç±»å¤´: 2å±‚MLP (256 â†’ 128 â†’ 2)                       â”‚                â”‚
â”‚  â”‚ â€¢ æŸå¤±å‡½æ•°: CrossEntropyLoss                           â”‚                â”‚
â”‚  â”‚ â€¢ ä¼˜åŒ–å™¨: AdamW (lr=1e-3)                              â”‚                â”‚
â”‚  â”‚ â€¢ StepæŒ‡æ ‡: Accuracy, AUROC, F1                        â”‚                â”‚
â”‚  â”‚ â€¢ EpochæŒ‡æ ‡: NLL, ECE                                  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                              â”‚
â”‚  Legacyæ¶æ„ (å¤‡ç”¨):                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ UrlBertEncoder (RoBERTa-base)                          â”‚                â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
â”‚  â”‚ â€¢ é¢„è®­ç»ƒæ¨¡å‹: roberta-base                             â”‚                â”‚
â”‚  â”‚ â€¢ Output embedding: 768-D                              â”‚                â”‚
â”‚  â”‚ â€¢ å‚æ•°é‡: ~110M                                        â”‚                â”‚
â”‚  â”‚ â€¢ ç”¨äºå¤šæ¨¡æ€å®éªŒ                                        â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. é…ç½®å±‚ (Configuration Layer)                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Hydraé…ç½®ç³»ç»Ÿ (configs/)                                                    â”‚
â”‚  â”œâ”€â”€ config.yaml           â† ä¸»é…ç½®ï¼ˆå®šä¹‰defaultsï¼‰                          â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â”œâ”€â”€ model/                â† æ¨¡å‹é…ç½®                                        â”‚
â”‚  â”‚   â”œâ”€â”€ url_encoder.yaml      (å­—ç¬¦çº§BiLSTM - é»˜è®¤)                        â”‚
â”‚  â”‚   â””â”€â”€ url_encoder_legacy.yaml (RoBERTa - å¤‡ç”¨)                          â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â”œâ”€â”€ data/                 â† æ•°æ®é…ç½®                                        â”‚
â”‚  â”‚   â””â”€â”€ url_only.yaml         (batch_size, paths, split_ratios)           â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â”œâ”€â”€ trainer/              â† è®­ç»ƒç¯å¢ƒé…ç½®                                    â”‚
â”‚  â”‚   â”œâ”€â”€ default.yaml          (é€šç”¨è®¾ç½®)                                   â”‚
â”‚  â”‚   â”œâ”€â”€ local.yaml            (CPU, bs=16)                                 â”‚
â”‚  â”‚   â””â”€â”€ server.yaml           (GPU, bs=32, fp16)                           â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â”œâ”€â”€ logger/               â† æ—¥å¿—é…ç½®                                        â”‚
â”‚  â”‚   â”œâ”€â”€ csv.yaml              (é»˜è®¤ï¼Œæœ¬åœ°CSV)                              â”‚
â”‚  â”‚   â”œâ”€â”€ tensorboard.yaml      (TensorBoardå¯è§†åŒ–)                          â”‚
â”‚  â”‚   â””â”€â”€ wandb.yaml            (WandBäº‘ç«¯è·Ÿè¸ª - æ¨è)                        â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â”œâ”€â”€ experiment/           â† å®éªŒé…ç½®                                        â”‚
â”‚  â”‚   â””â”€â”€ url_baseline.yaml     (é¢„è®¾å®éªŒé…ç½®)                               â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â””â”€â”€ profiles/             â† ç¯å¢ƒProfile (ä¼ ç»Ÿæ¨¡å¼å…¼å®¹)                     â”‚
â”‚      â”œâ”€â”€ local.yaml                                                          â”‚
â”‚      â””â”€â”€ server.yaml                                                         â”‚
â”‚                                                                              â”‚
â”‚  é…ç½®è¦†ç›–ä¼˜å…ˆçº§:                                                             â”‚
â”‚  å‘½ä»¤è¡Œå‚æ•° > ç¯å¢ƒå˜é‡ > é…ç½®æ–‡ä»¶ > defaults                                 â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. MLOpså±‚ (MLOps Layer)                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  æ•°æ®åˆ†å‰²åè®®:                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ 1. Random (é»˜è®¤)                                      â”‚                 â”‚
â”‚  â”‚    â€¢ åˆ†å±‚éšæœºåˆ†å‰² (stratify by label + brand)        â”‚                 â”‚
â”‚  â”‚    â€¢ é€‚ç”¨: æ ‡å‡†æœºå™¨å­¦ä¹ ä»»åŠ¡                           â”‚                 â”‚
â”‚  â”‚    â€¢ å‘½ä»¤: python scripts/train_hydra.py              â”‚                 â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚  â”‚ 2. Temporal (æ—¶é—´åºåˆ—)                               â”‚                 â”‚
â”‚  â”‚    â€¢ æŒ‰timestampå‡åºæ’åº                              â”‚                 â”‚
â”‚  â”‚    â€¢ Tie policy: left-closed                         â”‚                 â”‚
â”‚  â”‚    â€¢ é€‚ç”¨: æ—¶é—´æ•æ„Ÿçš„çœŸå®åœºæ™¯                         â”‚                 â”‚
â”‚  â”‚    â€¢ å‘½ä»¤: python scripts/train_hydra.py protocol=temporal             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚  â”‚ 3. Brand-OOD (å“ç‰ŒåŸŸå¤–æ³›åŒ–)                          â”‚                 â”‚
â”‚  â”‚    â€¢ ä¸¥æ ¼å“ç‰Œä¸ç›¸äº¤: train âˆ© test = âˆ…                â”‚                 â”‚
â”‚  â”‚    â€¢ å“ç‰Œå½’ä¸€åŒ–: strip().lower()                      â”‚                 â”‚
â”‚  â”‚    â€¢ é€‚ç”¨: æµ‹è¯•æ¨¡å‹æ³›åŒ–èƒ½åŠ›                           â”‚                 â”‚
â”‚  â”‚    â€¢ å‘½ä»¤: python scripts/train_hydra.py protocol=brand_ood            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                              â”‚
â”‚  è‡ªåŠ¨é™çº§æœºåˆ¶:                                                               â”‚
â”‚  â€¢ temporal â†’ random (ç¼ºå°‘timestamp)                                        â”‚
â”‚  â€¢ brand_ood â†’ random (ç¼ºå°‘brand / å“ç‰Œâ‰¤2 / ç›¸äº¤)                          â”‚
â”‚  â€¢ åŸå› è®°å½•åœ¨ metrics JSON å’Œ splits CSV                                    â”‚
â”‚                                                                              â”‚
â”‚  è¯„ä¼°æŒ‡æ ‡:                                                                   â”‚
â”‚  â€¢ Stepçº§: Accuracy, AUROC(pos=1), F1(macro)                                â”‚
â”‚  â€¢ Epochçº§: NLL, ECE (è‡ªé€‚åº”bins)                                           â”‚
â”‚  â€¢ bins = max(3, min(15, floor(âˆšN), 10))                                   â”‚
â”‚                                                                              â”‚
â”‚  è‡ªåŠ¨ç”Ÿæˆå·¥ä»¶:                                                               â”‚
â”‚  experiments/<run>/results/                                                  â”‚
â”‚  â”œâ”€â”€ roc_{protocol}.png         â† ROCæ›²çº¿ + AUCæ ‡æ³¨                         â”‚
â”‚  â”œâ”€â”€ calib_{protocol}.png       â† æ ¡å‡†æ›²çº¿ + ECEæ ‡æ³¨                        â”‚
â”‚  â”œâ”€â”€ splits_{protocol}.csv      â† æ•°æ®åˆ†å‰²ç»Ÿè®¡                              â”‚
â”‚  â”œâ”€â”€ metrics_{protocol}.json    â† å®Œæ•´æŒ‡æ ‡JSON                              â”‚
â”‚  â””â”€â”€ implementation_report.md   â† å®ç°æŠ¥å‘Š                                  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. å®éªŒç®¡ç†å±‚ (Experiment Management)                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  å®éªŒç›®å½•ç»“æ„:                                                               â”‚
â”‚  experiments/<å®éªŒå>_<æ—¶é—´æˆ³>/                                              â”‚
â”‚  â”œâ”€â”€ config.yaml              â† å®Œæ•´é…ç½®å¿«ç…§                                 â”‚
â”‚  â”œâ”€â”€ SUMMARY.md               â† Markdownæ ¼å¼æ€»ç»“                             â”‚
â”‚  â”œâ”€â”€ results/                 â† æ‰€æœ‰ç»“æœæ–‡ä»¶                                 â”‚
â”‚  â”‚   â”œâ”€â”€ metrics_*.json      â† æŒ‡æ ‡                                         â”‚
â”‚  â”‚   â”œâ”€â”€ roc_*.png           â† å¯è§†åŒ–                                       â”‚
â”‚  â”‚   â”œâ”€â”€ calib_*.png                                                        â”‚
â”‚  â”‚   â””â”€â”€ splits_*.csv        â† ç»Ÿè®¡                                         â”‚
â”‚  â”œâ”€â”€ logs/                    â† è®­ç»ƒæ—¥å¿—                                     â”‚
â”‚  â”‚   â”œâ”€â”€ train.log           â† å®Œæ•´æ—¥å¿—                                     â”‚
â”‚  â”‚   â””â”€â”€ metrics_history.csv â† å†å²æŒ‡æ ‡                                     â”‚
â”‚  â””â”€â”€ checkpoints/             â† æ¨¡å‹æƒé‡                                     â”‚
â”‚      â””â”€â”€ best-*.ckpt          â† æœ€ä½³æ¨¡å‹                                     â”‚
â”‚                                                                              â”‚
â”‚  Loggeræ”¯æŒ:                                                                 â”‚
â”‚  â€¢ CSV Logger (é»˜è®¤) - æœ¬åœ°æ–‡ä»¶                                             â”‚
â”‚  â€¢ TensorBoard - æœ¬åœ°å¯è§†åŒ–                                                 â”‚
â”‚  â€¢ WandB - äº‘ç«¯è·Ÿè¸ª (æ¨èç”Ÿäº§ç¯å¢ƒ)                                          â”‚
â”‚                                                                              â”‚
â”‚  å®éªŒå¯¹æ¯”:                                                                   â”‚
â”‚  python scripts/compare_experiments.py --latest 5                            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. ä»£ç ç»“æ„å±‚ (Code Structure)                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  src/                           â† æºä»£ç æ ¹ç›®å½•                               â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â”œâ”€â”€ data/                      â† æ•°æ®å¤„ç†                                   â”‚
â”‚  â”‚   â””â”€â”€ url_dataset.py            (UrlDataset - å­—ç¬¦çº§ç¼–ç )                â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â”œâ”€â”€ datamodules/               â† Lightning DataModule                      â”‚
â”‚  â”‚   â””â”€â”€ url_datamodule.py         (ç®¡ç†train/val/test)                     â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â”œâ”€â”€ models/                    â† æ¨¡å‹å®šä¹‰                                   â”‚
â”‚  â”‚   â”œâ”€â”€ url_encoder.py            (URLEncoder - ä¸»æµ)                      â”‚
â”‚  â”‚   â””â”€â”€ url_encoder_legacy.py     (UrlBertEncoder - Legacy)                â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â”œâ”€â”€ systems/                   â† Lightningè®­ç»ƒç³»ç»Ÿ                          â”‚
â”‚  â”‚   â””â”€â”€ url_only_module.py        (å®Œæ•´è®­ç»ƒæµç¨‹)                           â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â”œâ”€â”€ utils/                     â† å·¥å…·å‡½æ•°                                   â”‚
â”‚  â”‚   â”œâ”€â”€ callbacks.py              (Lightningå›è°ƒ)                          â”‚
â”‚  â”‚   â”œâ”€â”€ experiment_tracker.py     (å®éªŒè·Ÿè¸ª)                               â”‚
â”‚  â”‚   â”œâ”€â”€ visualizer.py             (å¯è§†åŒ–)                                 â”‚
â”‚  â”‚   â”œâ”€â”€ logging.py                (æ—¥å¿—)                                   â”‚
â”‚  â”‚   â”œâ”€â”€ seed.py                   (éšæœºç§å­)                               â”‚
â”‚  â”‚   â”œâ”€â”€ splits.py                 (æ•°æ®åˆ†å‰²åè®®) âœ¨æ–°å¢                    â”‚
â”‚  â”‚   â”œâ”€â”€ metrics.py                (æŒ‡æ ‡è®¡ç®—) âœ¨æ–°å¢                        â”‚
â”‚  â”‚   â”œâ”€â”€ batch_utils.py            (Batché€‚é…) âœ¨æ–°å¢                       â”‚
â”‚  â”‚   â””â”€â”€ protocol_artifacts.py     (å·¥ä»¶ç”Ÿæˆ) âœ¨æ–°å¢                        â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â””â”€â”€ modules/                   â† æ ¸å¿ƒæ¨¡å— (è§„åˆ’ä¸­)                         â”‚
â”‚      â”œâ”€â”€ uncertainty/               (ä¸ç¡®å®šæ€§ä¼°è®¡)                           â”‚
â”‚      â”œâ”€â”€ consistency/               (ä¸€è‡´æ€§æ£€æŸ¥)                             â”‚
â”‚      â””â”€â”€ fusion/                    (å¤šæ¨¡æ€èåˆ)                             â”‚
â”‚                                                                              â”‚
â”‚  scripts/                       â† å¯æ‰§è¡Œè„šæœ¬                                 â”‚
â”‚  â”œâ”€â”€ train_hydra.py                 (Hydraè®­ç»ƒ - æ¨è) âœ…                   â”‚
â”‚  â”œâ”€â”€ train.py                       (ä¼ ç»Ÿè®­ç»ƒ)                               â”‚
â”‚  â”œâ”€â”€ build_master_and_splits.py    (æ•°æ®é¢„å¤„ç†)                             â”‚
â”‚  â”œâ”€â”€ create_master_csv.py          (åˆ›å»ºä¸»è¡¨)                               â”‚
â”‚  â”œâ”€â”€ compare_experiments.py        (å®éªŒå¯¹æ¯”)                               â”‚
â”‚  â”œâ”€â”€ validate_data_schema.py       (æ•°æ®éªŒè¯)                               â”‚
â”‚  â”œâ”€â”€ run_all_protocols.ps1         (æ‰¹é‡å®éªŒ - Windows)                     â”‚
â”‚  â””â”€â”€ run_all_protocols.sh          (æ‰¹é‡å®éªŒ - Linux)                       â”‚
â”‚                                                                              â”‚
â”‚  tests/                         â† æµ‹è¯•ç›®å½•                                   â”‚
â”‚  â”œâ”€â”€ test_data.py                   (æ•°æ®æ¨¡å—)                               â”‚
â”‚  â”œâ”€â”€ test_models.py                 (æ¨¡å‹)                                   â”‚
â”‚  â”œâ”€â”€ test_url_encoder.py            (URLç¼–ç å™¨)                             â”‚
â”‚  â”œâ”€â”€ test_url_dataset.py            (æ•°æ®é›†)                                 â”‚
â”‚  â”œâ”€â”€ test_config.py                 (é…ç½®)                                   â”‚
â”‚  â”œâ”€â”€ test_utils.py                  (å·¥å…·)                                   â”‚
â”‚  â””â”€â”€ test_mlops_implementation.py   (MLOpsåŠŸèƒ½) âœ¨ 13/13é€šè¿‡                â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ å®Œæ•´ä½¿ç”¨æŒ‡å—

### ğŸ“¦ ç¬¬ä¸€æ­¥ï¼šç¯å¢ƒå®‰è£…

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/uaam-phish.git
cd uaam-phish

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv

# 3. æ¿€æ´»ç¯å¢ƒ
# Windows PowerShell:
.venv\Scripts\Activate.ps1
# Linux/Mac:
source .venv/bin/activate

# 4. å®‰è£…ä¾èµ–
pip install -e .

# 5. å®‰è£…MLOpså·¥å…·ï¼ˆå¯é€‰ï¼‰
pip install hydra-core wandb tensorboard pre-commit

# 6. å®‰è£…pre-commit hooksï¼ˆå¯é€‰ï¼‰
pre-commit install

# 7. åˆå§‹åŒ–DVCï¼ˆå¯é€‰ï¼‰
dvc init
```

### ğŸ“Š ç¬¬äºŒæ­¥ï¼šå‡†å¤‡æ•°æ®

#### æ–¹å¼Aï¼šä½¿ç”¨DVCç®¡é“ï¼ˆæ¨èï¼‰

```bash
# è¿è¡Œæ•°æ®é¢„å¤„ç†ç®¡é“
dvc repro

# éªŒè¯æ•°æ®schema
python scripts/validate_data_schema.py
```

#### æ–¹å¼Bï¼šæ‰‹åŠ¨é¢„å¤„ç†

```bash
# ä»åŸå§‹æ•°æ®æ„å»º
python scripts/build_master_and_splits.py \
  --benign data/raw/dataset \
  --phish data/raw/fish_dataset \
  --outdir data/processed \
  --train_frac 0.7 \
  --val_frac 0.15 \
  --test_frac 0.15

# æˆ–ä½¿ç”¨Makefile
make data
```

#### æ•°æ®æ ¼å¼è¦æ±‚

**å¿…éœ€åˆ—**:
- `url_text` (string): URLæ–‡æœ¬
- `label` (int): 0=è‰¯æ€§, 1=é’“é±¼

**å¯é€‰åˆ—**:
- `id`: æ ·æœ¬ID
- `domain`: åŸŸå
- `source`: æ•°æ®æº
- `timestamp`: æ—¶é—´æˆ³ï¼ˆtemporalåè®®éœ€è¦ï¼‰
- `brand`: å“ç‰Œï¼ˆbrand_oodåè®®éœ€è¦ï¼‰

ç¤ºä¾‹CSV:
```csv
url_text,label
http://example.com/login,0
http://paypal.verify.cn/account,1
```

### ğŸ¯ ç¬¬ä¸‰æ­¥ï¼šå¿«é€Ÿè®­ç»ƒ

#### æœ¬åœ°å¼€å‘ï¼ˆCPUï¼‰

```bash
# åŸºç¡€è®­ç»ƒï¼ˆé»˜è®¤randomåè®®ï¼‰
python scripts/train_hydra.py trainer=local

# å°æ•°æ®é›†å¿«é€Ÿæµ‹è¯•
python scripts/train_hydra.py \
  trainer=local \
  data.sample_fraction=0.1 \
  train.epochs=2

# ä½¿ç”¨temporalåè®®
python scripts/train_hydra.py \
  trainer=local \
  protocol=temporal
```

#### æœåŠ¡å™¨è®­ç»ƒï¼ˆGPUï¼‰

```bash
# å®Œæ•´è®­ç»ƒ + WandBè·Ÿè¸ª
export WANDB_PROJECT=uaam-phish
wandb login  # é¦–æ¬¡éœ€è¦ç™»å½•

python scripts/train_hydra.py \
  trainer=server \
  logger=wandb \
  run.name=my_experiment

# ä½¿ç”¨brand_oodåè®®
python scripts/train_hydra.py \
  trainer=server \
  logger=wandb \
  protocol=brand_ood \
  run.name=brand_ood_experiment
```

#### æ‰¹é‡è¿è¡Œæ‰€æœ‰åè®®

```powershell
# Windows PowerShell
.\scripts\run_all_protocols.ps1

# Linux/Mac
bash scripts/run_all_protocols.sh
```

è¿™å°†ä¾æ¬¡è¿è¡Œï¼š
1. randomåè®®
2. temporalåè®®
3. brand_oodåè®®

### âš™ï¸ ç¬¬å››æ­¥ï¼šé…ç½®ç³»ç»Ÿè¯¦è§£

#### åŸºç¡€é…ç½®è¦†ç›–

```bash
# ä¿®æ”¹å­¦ä¹ ç‡
python scripts/train_hydra.py train.lr=2e-5

# ä¿®æ”¹æ‰¹æ¬¡å¤§å°
python scripts/train_hydra.py train.bs=64

# ä¿®æ”¹dropout
python scripts/train_hydra.py model.dropout=0.3

# ä¿®æ”¹epochs
python scripts/train_hydra.py train.epochs=10

# ç»„åˆå¤šä¸ªå‚æ•°
python scripts/train_hydra.py \
  train.lr=1e-3 \
  train.bs=32 \
  train.epochs=15 \
  model.dropout=0.2
```

#### åˆ‡æ¢æ¨¡å‹æ¶æ„

```bash
# ä½¿ç”¨é»˜è®¤å­—ç¬¦çº§BiLSTMï¼ˆæ¨èï¼‰
python scripts/train_hydra.py model=url_encoder

# ä½¿ç”¨Legacy BERTæ¨¡å‹
python scripts/train_hydra.py \
  model=url_encoder_legacy \
  train.lr=2e-5 \
  train.bs=16
```

#### åˆ‡æ¢Logger

```bash
# CSV Loggerï¼ˆé»˜è®¤ï¼‰
python scripts/train_hydra.py logger=csv

# TensorBoard
python scripts/train_hydra.py logger=tensorboard

# WandBï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰
export WANDB_PROJECT=uaam-phish
python scripts/train_hydra.py logger=wandb
```

#### ä½¿ç”¨å®éªŒé…ç½®

```bash
# ä½¿ç”¨é¢„å®šä¹‰å®éªŒé…ç½®
python scripts/train_hydra.py experiment=url_baseline

# è¦†ç›–å®éªŒé…ç½®ä¸­çš„å‚æ•°
python scripts/train_hydra.py \
  experiment=url_baseline \
  train.lr=5e-4
```

#### è¶…å‚æ•°æœç´¢

```bash
# ç½‘æ ¼æœç´¢ï¼ˆHydra multirunï¼‰
python scripts/train_hydra.py -m \
  trainer=server \
  logger=wandb \
  train.lr=1e-3,5e-4,1e-4 \
  model.dropout=0.1,0.2,0.3

# è¿™å°†è¿è¡Œ 3Ã—3 = 9 æ¬¡å®éªŒ
```

### ğŸ“ˆ ç¬¬äº”æ­¥ï¼šæŸ¥çœ‹å’Œåˆ†æç»“æœ

#### æŸ¥çœ‹å•æ¬¡å®éªŒç»“æœ

```bash
# è¿›å…¥å®éªŒç›®å½•
cd experiments/<å®éªŒå>_<æ—¶é—´æˆ³>/

# æŸ¥çœ‹é…ç½®
cat config.yaml

# æŸ¥çœ‹æŒ‡æ ‡
cat results/metrics_random.json

# æŸ¥çœ‹åˆ†å‰²ç»Ÿè®¡
cat results/splits_random.csv

# æŸ¥çœ‹å®ç°æŠ¥å‘Š
cat results/implementation_report.md

# æŸ¥çœ‹è®­ç»ƒæ—¥å¿—
cat logs/train.log

# æŸ¥çœ‹å¯è§†åŒ–
# results/roc_random.png
# results/calib_random.png
```

#### å¯¹æ¯”å¤šä¸ªå®éªŒ

```bash
# å¯¹æ¯”æœ€è¿‘5ä¸ªå®éªŒ
python scripts/compare_experiments.py --latest 5

# å¯¹æ¯”ç‰¹å®šå®éªŒ
python scripts/compare_experiments.py \
  --exp_names exp1_20251023_120000 exp2_20251023_130000

# å¯¼å‡ºå¯¹æ¯”ç»“æœä¸ºCSV
python scripts/compare_experiments.py \
  --latest 10 \
  --output comparison.csv

# æŸ¥æ‰¾æœ€ä½³å®éªŒ
python scripts/compare_experiments.py \
  --find_best \
  --metric auroc
```

#### WandB Dashboard

å¦‚æœä½¿ç”¨WandB loggerï¼š

1. è®¿é—® https://wandb.ai
2. é€‰æ‹©ä½ çš„é¡¹ç›®
3. æŸ¥çœ‹ï¼š
   - è®­ç»ƒæ›²çº¿
   - æŒ‡æ ‡å¯¹æ¯”
   - è¶…å‚æ•°åˆ†æ
   - ç³»ç»Ÿç›‘æ§
   - å·¥ä»¶ï¼ˆå›¾ç‰‡ã€CSVç­‰ï¼‰

### ğŸ§ª ç¬¬å…­æ­¥ï¼šæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest tests/ -v

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest tests/test_mlops_implementation.py -v

# æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
pytest tests/ --cov=src --cov-report=html

# æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
# htmlcov/index.html
```

### ğŸ› ï¸ å¸¸ç”¨Makeå‘½ä»¤ï¼ˆå¯é€‰ï¼‰

```bash
# ç¯å¢ƒåˆå§‹åŒ–
make init

# æ•°æ®é¢„å¤„ç†
make data

# éªŒè¯æ•°æ®
make validate-data

# è¿è¡Œè®­ç»ƒ
make train

# è¿è¡Œæµ‹è¯•
make test

# ä»£ç æ£€æŸ¥
make lint

# æ ¼å¼åŒ–ä»£ç 
make format

# DVCæ“ä½œ
make dvc-init
make dvc-pull
make dvc-push
```

---

## ğŸ“š å®Œæ•´å‘½ä»¤å‚è€ƒ

### è®­ç»ƒå‘½ä»¤é€ŸæŸ¥è¡¨

| åœºæ™¯ | å‘½ä»¤ |
|------|------|
| **å¿«é€Ÿæµ‹è¯•** | `python scripts/train_hydra.py trainer=local data.sample_fraction=0.1 train.epochs=2` |
| **æœ¬åœ°å®Œæ•´è®­ç»ƒ** | `python scripts/train_hydra.py trainer=local` |
| **GPUè®­ç»ƒ** | `python scripts/train_hydra.py trainer=server` |
| **GPU + WandB** | `python scripts/train_hydra.py trainer=server logger=wandb` |
| **Temporalåè®®** | `python scripts/train_hydra.py protocol=temporal` |
| **Brand-OODåè®®** | `python scripts/train_hydra.py protocol=brand_ood` |
| **ä½¿ç”¨Legacy BERT** | `python scripts/train_hydra.py model=url_encoder_legacy train.lr=2e-5` |
| **è¶…å‚æ•°æœç´¢** | `python scripts/train_hydra.py -m train.lr=1e-3,5e-4 model.dropout=0.1,0.2` |
| **è‡ªå®šä¹‰å®éªŒå** | `python scripts/train_hydra.py run.name=my_experiment` |

### æ•°æ®å¤„ç†å‘½ä»¤

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| **DVCé¢„å¤„ç†** | `dvc repro` |
| **æ‰‹åŠ¨é¢„å¤„ç†** | `python scripts/build_master_and_splits.py --benign data/raw/dataset --phish data/raw/fish_dataset` |
| **åˆ›å»ºä¸»è¡¨** | `python scripts/create_master_csv.py` |
| **éªŒè¯Schema** | `python scripts/validate_data_schema.py` |
| **ä¿®å¤æ•°æ®** | `python scripts/fix_data_schema.py` |
| **æ£€æŸ¥é‡å ** | `python check_overlap.py` |

### å®éªŒç®¡ç†å‘½ä»¤

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| **å¯¹æ¯”æœ€è¿‘5ä¸ª** | `python scripts/compare_experiments.py --latest 5` |
| **å¯¹æ¯”ç‰¹å®šå®éªŒ** | `python scripts/compare_experiments.py --exp_names exp1 exp2` |
| **æŸ¥æ‰¾æœ€ä½³** | `python scripts/compare_experiments.py --find_best --metric auroc` |
| **å¯¼å‡ºå¯¹æ¯”ç»“æœ** | `python scripts/compare_experiments.py --latest 10 --output result.csv` |

### æµ‹è¯•å‘½ä»¤

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| **æ‰€æœ‰æµ‹è¯•** | `pytest tests/ -v` |
| **ç‰¹å®šæµ‹è¯•** | `pytest tests/test_mlops_implementation.py -v` |
| **è¦†ç›–ç‡** | `pytest tests/ --cov=src --cov-report=html` |
| **å¿«é€Ÿæµ‹è¯•** | `pytest tests/ -x` ï¼ˆé‡é”™å³åœï¼‰|

---

## ğŸ“ æœ€ä½³å®è·µ

### å¼€å‘å·¥ä½œæµ

1. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**
   ```bash
   git checkout -b feature/my-feature
   ```

2. **æœ¬åœ°å¿«é€Ÿè¿­ä»£**
   ```bash
   python scripts/train_hydra.py \
     trainer=local \
     data.sample_fraction=0.1 \
     train.epochs=2
   ```

3. **è¿è¡Œæµ‹è¯•**
   ```bash
   pytest tests/ -v
   ```

4. **ä»£ç æ£€æŸ¥**
   ```bash
   pre-commit run --all-files
   # æˆ–
   ruff check . --fix
   black .
   ```

5. **å®Œæ•´è®­ç»ƒéªŒè¯**
   ```bash
   python scripts/train_hydra.py \
     trainer=server \
     logger=wandb
   ```

6. **æäº¤ä»£ç **
   ```bash
   git add .
   git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"
   git push origin feature/my-feature
   ```

### å®éªŒç®¡ç†æœ€ä½³å®è·µ

1. **ä½¿ç”¨æœ‰æ„ä¹‰çš„å®éªŒåç§°**
   ```bash
   python scripts/train_hydra.py \
     run.name=baseline_lr1e3_bs32_dropout02
   ```

2. **è®°å½•å®éªŒç›®çš„**
   - åœ¨å®éªŒå¼€å§‹å‰è®°å½•å‡è®¾
   - åœ¨SUMMARY.mdä¸­æ·»åŠ æ³¨é‡Š

3. **ä½¿ç”¨WandBè¿›è¡Œæ­£å¼å®éªŒ**
   ```bash
   export WANDB_PROJECT=uaam-phish
   export WANDB_ENTITY=your-team
   python scripts/train_hydra.py logger=wandb
   ```

4. **å®šæœŸæ¸…ç†æ—§å®éªŒ**
   ```bash
   # ä¿ç•™æœ€è¿‘30ä¸ªå®éªŒï¼Œåˆ é™¤å…¶ä»–
   ls -t experiments/ | tail -n +31 | xargs rm -rf
   ```

### æ•°æ®ç®¡ç†æœ€ä½³å®è·µ

1. **å§‹ç»ˆéªŒè¯æ•°æ®**
   ```bash
   python scripts/validate_data_schema.py
   ```

2. **ä½¿ç”¨DVCè·Ÿè¸ªæ•°æ®ç‰ˆæœ¬**
   ```bash
   dvc add data/raw/
   dvc add data/processed/
   git add data/*.dvc .gitignore
   git commit -m "data: æ·»åŠ æ–°æ•°æ®é›†"
   ```

3. **å®šæœŸæ£€æŸ¥æ•°æ®è´¨é‡**
   ```bash
   python check_overlap.py
   ```

---

## âš ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜æ±‡æ€»

#### 1. Hydraæ‰¾ä¸åˆ°é…ç½®

**ç—‡çŠ¶**:
```
MissingConfigException: Cannot find config file 'config.yaml'
```

**è§£å†³**:
```bash
# ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•
cd /path/to/uaam-phish
pwd

# æ£€æŸ¥configsç›®å½•
ls configs/config.yaml
```

#### 2. WandBç™»å½•å¤±è´¥

**ç—‡çŠ¶**:
```
wandb: ERROR Unable to connect to W&B
```

**è§£å†³**:
```bash
# æ–¹å¼A: é‡æ–°ç™»å½•
wandb login --relogin

# æ–¹å¼B: ä½¿ç”¨API key
export WANDB_API_KEY=your_api_key_here

# æ–¹å¼C: ç¦»çº¿æ¨¡å¼
export WANDB_MODE=offline
python scripts/train_hydra.py logger=wandb
```

#### 3. CUDA Out of Memory

**ç—‡çŠ¶**:
```
RuntimeError: CUDA out of memory
```

**è§£å†³**:
```bash
# å‡å°æ‰¹æ¬¡å¤§å°
python scripts/train_hydra.py train.bs=16

# æˆ–ä½¿ç”¨CPU
python scripts/train_hydra.py trainer=local

# æˆ–å¯ç”¨æ¢¯åº¦æ£€æŸ¥ç‚¹ï¼ˆå¦‚æœæ”¯æŒï¼‰
python scripts/train_hydra.py train.gradient_checkpointing=true
```

#### 4. æ•°æ®SchemaéªŒè¯å¤±è´¥

**ç—‡çŠ¶**:
```
[ERROR] ç¼ºå°‘å¿…éœ€åˆ—: url_text
```

**è§£å†³**:
```bash
# æ£€æŸ¥CSVæ–‡ä»¶
head data/processed/train.csv

# è¿è¡Œæ•°æ®ä¿®å¤
python scripts/fix_data_schema.py

# é‡æ–°é¢„å¤„ç†
dvc repro
```

#### 5. Protocolé™çº§åˆ°Random

**ç—‡çŠ¶**:
```
WARNING: Downgraded to random split due to missing timestamp
```

**è§£å†³**:
```bash
# æ£€æŸ¥æ•°æ®æ˜¯å¦åŒ…å«å¿…éœ€åˆ—
python -c "import pandas as pd; print(pd.read_csv('data/processed/train.csv').columns)"

# å¯¹äºtemporalåè®®ï¼Œéœ€è¦timestampåˆ—
# å¯¹äºbrand_oodåè®®ï¼Œéœ€è¦brandåˆ—

# æŸ¥çœ‹é™çº§åŸå› 
cat experiments/<run>/results/metrics_*.json | grep downgraded_reason
```

#### 6. Import Error

**ç—‡çŠ¶**:
```
ModuleNotFoundError: No module named 'src'
```

**è§£å†³**:
```bash
# ç¡®ä¿ä»¥å¯ç¼–è¾‘æ¨¡å¼å®‰è£…
pip install -e .

# æˆ–è®¾ç½®PYTHONPATH
export PYTHONPATH="${PYTHONPATH}:${PWD}"
```

#### 7. Pre-commitå¤±è´¥

**ç—‡çŠ¶**:
```
pre-commit hook failed
```

**è§£å†³**:
```bash
# è‡ªåŠ¨ä¿®å¤
ruff check . --fix
black .

# é‡æ–°æäº¤
git add .
git commit -m "fix: ä¿®å¤æ ¼å¼é—®é¢˜"
```

---

## ğŸ“– å®Œæ•´æ–‡æ¡£ç´¢å¼•

### æ ¸å¿ƒæ–‡æ¡£

| æ–‡æ¡£ | æè¿° | è·¯å¾„ |
|------|------|------|
| **å¿«é€Ÿå¼€å§‹** | 5åˆ†é’Ÿå…¥é—¨ | [QUICKSTART.md](QUICKSTART.md) |
| **MLOpså¿«é€Ÿå¼€å§‹** | MLOpsåŠŸèƒ½å…¥é—¨ | [QUICKSTART_MLOPS.md](QUICKSTART_MLOPS.md) |
| **MLOpsåè®®æŒ‡å—** | æ•°æ®åˆ†å‰²åè®®è¯¦è§£ | [docs/QUICKSTART_MLOPS_PROTOCOLS.md](docs/QUICKSTART_MLOPS_PROTOCOLS.md) |
| **é¡¹ç›®æ¶æ„** | å®Œæ•´æ¶æ„è¯´æ˜ | [docs/PROJECT_ARCHITECTURE_CN.md](docs/PROJECT_ARCHITECTURE_CN.md) |
| **é¡¹ç›®ç»“æ„** | ç›®å½•ç»“æ„è¯¦è§£ | [docs/ROOT_STRUCTURE.md](docs/ROOT_STRUCTURE.md) |
| **å®‰è£…æŒ‡å—** | è¯¦ç»†å®‰è£…æ­¥éª¤ | [INSTALL.md](INSTALL.md) |

### åŠŸèƒ½æ–‡æ¡£

| æ–‡æ¡£ | æè¿° | è·¯å¾„ |
|------|------|------|
| **æ•°æ®Schema** | æ•°æ®æ ¼å¼è§„èŒƒ | [docs/DATA_SCHEMA.md](docs/DATA_SCHEMA.md) |
| **å®éªŒç®¡ç†** | å®éªŒè·Ÿè¸ªå’Œå¯¹æ¯” | [docs/EXPERIMENTS.md](docs/EXPERIMENTS.md) |
| **WandBæŒ‡å—** | WandBé›†æˆä½¿ç”¨ | [docs/WANDB_GUIDE.md](docs/WANDB_GUIDE.md) |
| **CI/CDæŒ‡å—** | æŒç»­é›†æˆé…ç½® | [docs/CI_CD_GUIDE.md](docs/CI_CD_GUIDE.md) |
| **æµ‹è¯•æŒ‡å—** | æµ‹è¯•ç¼–å†™è§„èŒƒ | [docs/TESTING_GUIDE.md](docs/TESTING_GUIDE.md) |
| **MLOpsæ”¹è¿›** | MLOpså‡çº§æ€»ç»“ | [docs/MLOPS_IMPROVEMENTS_2025-10-22.md](docs/MLOPS_IMPROVEMENTS_2025-10-22.md) |

### å®ç°æ–‡æ¡£

| æ–‡æ¡£ | æè¿° | è·¯å¾„ |
|------|------|------|
| **å®ç°æŠ¥å‘Š** | å®Œæ•´å®ç°ç»†èŠ‚ | [IMPLEMENTATION_REPORT.md](IMPLEMENTATION_REPORT.md) |
| **å˜æ›´æ‘˜è¦** | ä»£ç å˜æ›´è®°å½• | [CHANGES_SUMMARY.md](CHANGES_SUMMARY.md) |
| **æ¶æ„æ¾„æ¸…** | æ¶æ„è®¾è®¡è¯´æ˜ | [docs/ARCHITECTURE_CLARIFICATION.md](docs/ARCHITECTURE_CLARIFICATION.md) |

### çŠ¶æ€æŠ¥å‘Š

| æ–‡æ¡£ | æè¿° | è·¯å¾„ |
|------|------|------|
| **æœ€ç»ˆæ€»ç»“ï¼ˆæœ¬æ–‡æ¡£ï¼‰** | å®Œæ•´é¡¹ç›®æ€»ç»“ | [FINAL_SUMMARY_CN.md](FINAL_SUMMARY_CN.md) |
| **MLOpsçŠ¶æ€** | MLOpsåŠŸèƒ½çŠ¶æ€ | [MLOPS_STATUS_REPORT.md](MLOPS_STATUS_REPORT.md) |
| **éªŒè¯æŠ¥å‘Š** | åŠŸèƒ½éªŒè¯ç»“æœ | [docs/VALIDATION_REPORT.md](docs/VALIDATION_REPORT.md) |

---

## ğŸ”¥ å¿«é€Ÿå‚è€ƒå¡ç‰‡

### ä¸€åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

```bash
# 1. å®‰è£…
pip install -e .

# 2. å‡†å¤‡æ•°æ®
dvc repro

# 3. è®­ç»ƒ
python scripts/train_hydra.py

# 4. æŸ¥çœ‹ç»“æœ
ls experiments/
```

### æœ€å¸¸ç”¨å‘½ä»¤

```bash
# æœ¬åœ°å¿«é€Ÿæµ‹è¯•
python scripts/train_hydra.py trainer=local data.sample_fraction=0.1 train.epochs=2

# GPUå®Œæ•´è®­ç»ƒ
python scripts/train_hydra.py trainer=server logger=wandb

# è¿è¡Œæ‰€æœ‰åè®®
.\scripts\run_all_protocols.ps1

# å¯¹æ¯”å®éªŒ
python scripts/compare_experiments.py --latest 5
```

### é…ç½®é€ŸæŸ¥

```yaml
# ä¸»è¦é…ç½®è·¯å¾„
configs/
â”œâ”€â”€ config.yaml           # ä¸»é…ç½®
â”œâ”€â”€ model/url_encoder.yaml # æ¨¡å‹
â”œâ”€â”€ data/url_only.yaml    # æ•°æ®
â”œâ”€â”€ trainer/server.yaml   # è®­ç»ƒå™¨
â””â”€â”€ logger/wandb.yaml     # æ—¥å¿—
```

### å…³é”®ç›®å½•

```
data/processed/    # æ•°æ®
experiments/       # å®éªŒç»“æœ
src/              # æºä»£ç 
tests/            # æµ‹è¯•
configs/          # é…ç½®
scripts/          # è„šæœ¬
docs/             # æ–‡æ¡£
```

---

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| **æ€»ä»£ç è¡Œæ•°** | ~8,000 |
| **æºä»£ç æ–‡ä»¶** | 25+ |
| **é…ç½®æ–‡ä»¶** | 15+ |
| **æµ‹è¯•ç”¨ä¾‹** | 50+ |
| **æµ‹è¯•é€šè¿‡ç‡** | 100% |
| **æ–‡æ¡£é¡µæ•°** | 3,000+ è¡Œ |
| **æ”¯æŒçš„åè®®** | 3 (random, temporal, brand_ood) |
| **æ”¯æŒçš„Logger** | 3 (CSV, TensorBoard, WandB) |
| **æ¨¡å‹æ¶æ„** | 2 (BiLSTM, BERT) |

---

## ğŸ¯ é¡¹ç›®ä¼˜åŠ¿

### âœ… ä¸“ä¸šçº§MLOpsæ¶æ„
- Hydraé…ç½®ç®¡ç†
- WandBå®éªŒè·Ÿè¸ª
- DVCæ•°æ®ç‰ˆæœ¬æ§åˆ¶
- CI/CDè‡ªåŠ¨åŒ–

### âœ… å®Œæ•´çš„æ•°æ®åè®®
- Randomåˆ†å‰²
- Temporalåˆ†å‰²
- Brand-OODåˆ†å‰²
- è‡ªåŠ¨é™çº§æœºåˆ¶

### âœ… å…¨é¢çš„æŒ‡æ ‡ç³»ç»Ÿ
- Stepçº§æŒ‡æ ‡ (Accuracy, AUROC, F1)
- Epochçº§æŒ‡æ ‡ (NLL, ECE)
- è‡ªé€‚åº”bins
- DDPæ”¯æŒ

### âœ… å¼ºå¤§çš„å¯è§†åŒ–
- ROCæ›²çº¿ + AUC
- æ ¡å‡†æ›²çº¿ + ECE
- è®­ç»ƒæ›²çº¿
- æ··æ·†çŸ©é˜µ

### âœ… çµæ´»çš„æ¶æ„
- åŒç¼–ç å™¨æ”¯æŒ (BiLSTM / BERT)
- å¤šç¯å¢ƒé…ç½® (local / server)
- æ˜“äºæ‰©å±•åˆ°å¤šæ¨¡æ€

### âœ… å®Œå–„çš„æ–‡æ¡£
- ä¸­è‹±æ–‡æ–‡æ¡£é½å…¨
- å¿«é€Ÿå¼€å§‹æŒ‡å—
- è¯¦ç»†APIæ–‡æ¡£
- æ•…éšœæ’é™¤æŒ‡å—

---

## ğŸš€ ä¸‹ä¸€æ­¥å‘å±•

### çŸ­æœŸè®¡åˆ’ (1-2ä¸ªæœˆ)
- [ ] å®ç°ä¸ç¡®å®šæ€§ä¼°è®¡æ¨¡å—
- [ ] å®ç°ä¸€è‡´æ€§æ£€æŸ¥æ¨¡å—
- [ ] æ·»åŠ HTMLç¼–ç å™¨
- [ ] æ·»åŠ å›¾åƒç¼–ç å™¨

### ä¸­æœŸè®¡åˆ’ (3-6ä¸ªæœˆ)
- [ ] å®ç°RCAFèåˆæ¨¡å—
- [ ] å®Œæ•´çš„å¤šæ¨¡æ€ç³»ç»Ÿ
- [ ] æ¨¡å‹ä¼˜åŒ–å’Œå‹ç¼©
- [ ] APIæœåŠ¡åŒ–

### é•¿æœŸæ„¿æ™¯ (6-12ä¸ªæœˆ)
- [ ] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- [ ] å®æ—¶ç›‘æ§ç³»ç»Ÿ
- [ ] A/Bæµ‹è¯•æ¡†æ¶
- [ ] æŒç»­å­¦ä¹ æœºåˆ¶

---

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

### 1. å¹‚ç­‰æ€§è®¾è®¡
æ‰€æœ‰å®ç°éƒ½æ˜¯å¹‚ç­‰çš„ï¼Œå¤šæ¬¡è¿è¡Œä¸ä¼šäº§ç”Ÿå‰¯ä½œç”¨ã€‚

### 2. å‘åå…¼å®¹
æ–°åŠŸèƒ½ä¸ç ´åç°æœ‰ä»£ç ï¼ŒLegacyæ¨¡å¼å§‹ç»ˆå¯ç”¨ã€‚

### 3. è‡ªåŠ¨é™çº§
æ™ºèƒ½å¤„ç†ç¼ºå¤±æ•°æ®ï¼Œè‡ªåŠ¨é™çº§åˆ°å¯ç”¨åè®®ã€‚

### 4. å®Œæ•´ä¿æŠ¤
URLç¼–ç å™¨æ¶æ„é”å®šï¼Œé˜²æ­¢æ„å¤–ä¿®æ”¹ã€‚

### 5. æµ‹è¯•é©±åŠ¨
100%æµ‹è¯•è¦†ç›–æ ¸å¿ƒåŠŸèƒ½ï¼Œç¡®ä¿è´¨é‡ã€‚

---

## ğŸ“ è·å–å¸®åŠ©

### é‡åˆ°é—®é¢˜ï¼Ÿ

1. **æŸ¥çœ‹æ–‡æ¡£**
   - é¦–å…ˆæŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæ’é™¤éƒ¨åˆ†
   - é˜…è¯»ç›¸å…³åŠŸèƒ½çš„è¯¦ç»†æ–‡æ¡£

2. **æŸ¥çœ‹æ—¥å¿—**
   ```bash
   cat experiments/<run>/logs/train.log
   cat experiments/<run>/results/implementation_report.md
   ```

3. **è¿è¡Œæµ‹è¯•**
   ```bash
   pytest tests/ -v
   ```

4. **æäº¤Issue**
   - æè¿°é—®é¢˜
   - é™„ä¸Šæ—¥å¿—
   - è¯´æ˜ç¯å¢ƒä¿¡æ¯

### éœ€è¦æ–°åŠŸèƒ½ï¼Ÿ

1. æŸ¥çœ‹é¡¹ç›®è·¯çº¿å›¾
2. æäº¤Feature Request
3. æˆ–ç›´æ¥æäº¤Pull Request

---

## ğŸ‰ æ€»ç»“

**UAAM-Phish** æ˜¯ä¸€ä¸ªä¸“ä¸šçº§çš„é’“é±¼æ£€æµ‹ç³»ç»Ÿï¼Œå…·æœ‰ï¼š

âœ… **å®Œæ•´çš„MLOpsæµç¨‹**
âœ… **çµæ´»çš„é…ç½®ç³»ç»Ÿ**
âœ… **å¼ºå¤§çš„å®éªŒç®¡ç†**
âœ… **å…¨é¢çš„æŒ‡æ ‡ç›‘æ§**
âœ… **è¯¦å°½çš„æ–‡æ¡£æ”¯æŒ**
âœ… **100%æµ‹è¯•è¦†ç›–**

**çŠ¶æ€**: ğŸŸ¢ **ç”Ÿäº§å°±ç»ª**
**è´¨é‡**: â­â­â­â­â­ **5/5**
**æ¨èåº¦**: ğŸ‘ğŸ‘ğŸ‘ **å¼ºçƒˆæ¨è**

---

**æ„Ÿè°¢ä½¿ç”¨ UAAM-Phish! ç¥è®­ç»ƒé¡ºåˆ©ï¼ğŸš€**
